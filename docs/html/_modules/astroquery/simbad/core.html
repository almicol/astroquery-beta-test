<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astroquery.simbad.core &#8212; astroquery v0.4.8.dev10177</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=51006566"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">query</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">astroquery v0.4.8.dev10177</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >Module code</a> &#187;</li>
      <li><a href="../simbad.html" accesskey="U">astroquery.simbad</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astroquery.simbad.core</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="sd">&quot;&quot;&quot;SIMBAD query class for accessing the SIMBAD Service&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span> <span class="nn">difflib</span> <span class="kn">import</span> <span class="n">get_close_matches</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">astropy.coordinates</span> <span class="k">as</span> <span class="nn">coord</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">vstack</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.utils</span> <span class="kn">import</span> <span class="n">isiterable</span><span class="p">,</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">astropy.utils.decorators</span> <span class="kn">import</span> <span class="n">deprecated_renamed_argument</span>

<span class="kn">from</span> <span class="nn">astroquery.query</span> <span class="kn">import</span> <span class="n">BaseVOQuery</span>
<span class="kn">from</span> <span class="nn">astroquery.utils</span> <span class="kn">import</span> <span class="n">commons</span>
<span class="kn">from</span> <span class="nn">astroquery.exceptions</span> <span class="kn">import</span> <span class="n">NoResultsWarning</span>
<span class="kn">from</span> <span class="nn">astroquery.simbad.utils</span> <span class="kn">import</span> <span class="p">(</span><span class="n">_catch_deprecated_fields_with_arguments</span><span class="p">,</span>
                                     <span class="n">_wildcard_to_regexp</span><span class="p">,</span> <span class="n">CriteriaTranslator</span><span class="p">,</span>
                                     <span class="n">query_criteria_fields</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pyvo.dal</span> <span class="kn">import</span> <span class="n">TAPService</span><span class="p">,</span> <span class="n">TAPQuery</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">conf</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Simbad&#39;</span><span class="p">,</span> <span class="s1">&#39;SimbadClass&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_adql_parameter</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replace single quotes by two single quotes.</span>

<span class="sd">    This should be applied to parameters used in ADQL queries.</span>
<span class="sd">    It is not a SQL injection protection: it just allows to search, for example,</span>
<span class="sd">    for authors with quotes in their names or titles/descriptions with apostrophes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    entry : str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">entry</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>


<span class="nd">@lru_cache</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_cached_query_tap</span><span class="p">(</span><span class="n">tap</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cache version of query TAP.</span>

<span class="sd">    This private function is called when query_tap is executed without an</span>
<span class="sd">    ``uploads`` extra keyword argument. This is a work around because</span>
<span class="sd">    `~astropy.table.Table` objects are not hashable and thus cannot</span>
<span class="sd">    be used as arguments for a function decorated with lru_cache.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tap : `~pyvo.dal.TAPService`</span>
<span class="sd">        The TAP service to query SIMBAD.</span>
<span class="sd">    query : str</span>
<span class="sd">        A string containing the query written in the</span>
<span class="sd">        Astronomical Data Query Language (ADQL).</span>
<span class="sd">    maxrec : int, optional</span>
<span class="sd">        The number of records to be returned. Its maximum value is 2000000.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    `~astropy.table.Table`</span>
<span class="sd">        The response returned by SIMBAD.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">tap</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>


<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">_Column</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class to define a column in a SIMBAD query.&quot;&quot;&quot;</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>


<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">_Join</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class to define a join between two tables.&quot;&quot;&quot;</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">column_left</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">column_right</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">join_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;JOIN&quot;</span><span class="p">)</span>
    <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>


<div class="viewcode-block" id="SimbadClass">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass">[docs]</a>
<span class="k">class</span> <span class="nc">SimbadClass</span><span class="p">(</span><span class="n">BaseVOQuery</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The class for querying the SIMBAD web service.</span>

<span class="sd">    Note that SIMBAD suggests submitting no more than 6 queries per second; if</span>
<span class="sd">    you submit more than that, your IP may be temporarily blacklisted</span>
<span class="sd">    (https://simbad.cds.unistra.fr/guide/sim-url.htx)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">SIMBAD_URL</span> <span class="o">=</span> <span class="s1">&#39;https://&#39;</span> <span class="o">+</span> <span class="n">conf</span><span class="o">.</span><span class="n">server</span> <span class="o">+</span> <span class="s1">&#39;/simbad/sim-script&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ROW_LIMIT</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># to create the TAPService</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tap</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hardlimit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uploadlimit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># attributes to construct ADQL queries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns_in_output</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># a list of _Column</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joins</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># a list of _Join</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># a list of strings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">=</span> <span class="n">ROW_LIMIT</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ROW_LIMIT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ROW_LIMIT</span>

    <span class="nd">@ROW_LIMIT</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ROW_LIMIT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ROW_LIMIT</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ROW_LIMIT</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ROW_LIMIT</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">row_limit</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ROW_LIMIT</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ROW_LIMIT</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ROW_LIMIT</span> <span class="o">=</span> <span class="n">ROW_LIMIT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ROW_LIMIT can be either -1 to set the limit to SIMBAD&#39;s &quot;</span>
                             <span class="s2">&quot;maximum capability, 0 to retrieve an empty table, &quot;</span>
                             <span class="s2">&quot;or a positive integer.&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The SIMBAD mirror to use.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server</span>

    <span class="nd">@server</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allows to switch server between SIMBAD mirrors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server : str</span>
<span class="sd">            It should be one of `~astroquery.simbad.conf.servers_list`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">conf</span><span class="o">.</span><span class="n">servers_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_server</span> <span class="o">=</span> <span class="n">server</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&#39; does not correspond to a SIMBAD server, &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;the two existing ones are </span><span class="si">{</span><span class="n">conf</span><span class="o">.</span><span class="n">servers_list</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A `~pyvo.dal.TAPService` service for SIMBAD.&quot;&quot;&quot;</span>
        <span class="n">tap_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">server</span><span class="si">}</span><span class="s2">/simbad/sim-tap&quot;</span>
        <span class="c1"># only creates a new tap instance if there are no existing one</span>
        <span class="c1"># or if the server property changed since the last getter call.</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tap</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tap</span><span class="o">.</span><span class="n">baseurl</span> <span class="o">!=</span> <span class="n">tap_url</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tap</span> <span class="o">=</span> <span class="n">TAPService</span><span class="p">(</span><span class="n">baseurl</span><span class="o">=</span><span class="n">tap_url</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tap</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hardlimit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The maximum number of lines for SIMBAD&#39;s output.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hardlimit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hardlimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="n">hardlimit</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hardlimit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">uploadlimit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uploadlimit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_uploadlimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="n">get_tap_capability</span><span class="p">()</span><span class="o">.</span><span class="n">uploadlimit</span><span class="o">.</span><span class="n">hard</span><span class="o">.</span><span class="n">content</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uploadlimit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns_in_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of _Column.</span>

<span class="sd">        They will be included in the output of the following methods:</span>

<span class="sd">        - `query_object`,</span>
<span class="sd">        - `query_objects`,</span>
<span class="sd">        - `query_region`,</span>
<span class="sd">        - `query_catalog`,</span>
<span class="sd">        - `query_hierarchy`,</span>
<span class="sd">        - `query_bibobj`,</span>
<span class="sd">        - `query_criteria`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns_in_output</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_columns_in_output</span> <span class="o">=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                                       <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">conf</span><span class="o">.</span><span class="n">default_columns</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns_in_output</span>

    <span class="nd">@columns_in_output</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">columns_in_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_columns</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns_in_output</span> <span class="o">=</span> <span class="n">list_columns</span>

<div class="viewcode-block" id="SimbadClass.list_wildcards">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.list_wildcards">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">list_wildcards</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays the available wildcards that may be used in SIMBAD queries and</span>
<span class="sd">        their usage.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.list_wildcards()</span>
<span class="sd">        *: Any string of characters (including an empty one)</span>
<span class="sd">        ?: Any character (exactly one character)</span>
<span class="sd">        [abc]: Exactly one character taken in the list. Can also be defined by a range of characters: [A-Z]</span>
<span class="sd">        [^0-9]: Any (one) character not in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WILDCARDS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="s1">&#39;Any string of characters (including an empty one)&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;?&#39;</span><span class="p">:</span> <span class="s1">&#39;Any character (exactly one character)&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[abc]&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Exactly one character taken in the list. &#39;</span>
                               <span class="s1">&#39;Can also be defined by a range of characters: [A-Z]&#39;</span><span class="p">),</span>
                     <span class="s1">&#39;[^0-9]&#39;</span><span class="p">:</span> <span class="s1">&#39;Any (one) character not in the list.&#39;</span><span class="p">}</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">WILDCARDS</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span></div>


    <span class="c1"># ---------------------------------</span>
    <span class="c1"># Methods to define SIMBAD&#39;s output</span>
    <span class="c1"># ---------------------------------</span>

<div class="viewcode-block" id="SimbadClass.list_votable_fields">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.list_votable_fields">[docs]</a>
    <span class="k">def</span> <span class="nf">list_votable_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List all options to add columns to SIMBAD&#39;s output.</span>

<span class="sd">        They are of four types:</span>

<span class="sd">        - &quot;column of basic&quot;: a column of the basic table. There fields can also be explored with</span>
<span class="sd">          `~astroquery.simbad.SimbadClass.list_columns`.</span>
<span class="sd">        - &quot;table&quot;: a table other than basic that has a declared direct join</span>
<span class="sd">        - &quot;bundle of basic columns&quot;: a pre-selected bundle of columns of basic. Ex: &quot;parallax&quot; will add all</span>
<span class="sd">          columns relevant to parallax</span>
<span class="sd">        - &quot;filter name&quot;: an optical filter name</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; options = Simbad.list_votable_fields() # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; # to print only the available bundles of columns</span>
<span class="sd">        &gt;&gt;&gt; options[options[&quot;type&quot;] == &quot;bundle of basic columns&quot;][[&quot;name&quot;, &quot;description&quot;]] # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=9&gt;</span>
<span class="sd">             name                           description</span>
<span class="sd">            object                             object</span>
<span class="sd">        ------------- -------------------------------------------------------</span>
<span class="sd">          coordinates                     all fields related with coordinates</span>
<span class="sd">                  dim             major and minor axis, angle and inclination</span>
<span class="sd">           dimensions                 all fields related to object dimensions</span>
<span class="sd">            morphtype            all fields related to the morphological type</span>
<span class="sd">             parallax                        all fields related to parallaxes</span>
<span class="sd">        propermotions              all fields related with the proper motions</span>
<span class="sd">                   sp               all fields related with the spectral type</span>
<span class="sd">             velocity    all fields related with radial velocity and redshift</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the tables with a simple link to basic</span>
        <span class="n">query_tables</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT DISTINCT table_name AS name, tables.description</span>
<span class="s2">        FROM TAP_SCHEMA.keys JOIN  TAP_SCHEMA.key_columns USING (key_id)</span>
<span class="s2">        JOIN TAP_SCHEMA.tables ON TAP_SCHEMA.keys.from_table = TAP_SCHEMA.tables.table_name</span>
<span class="s2">        OR TAP_SCHEMA.keys.target_table = TAP_SCHEMA.tables.table_name</span>
<span class="s2">        WHERE TAP_SCHEMA.tables.schema_name = &#39;public&#39;</span>
<span class="s2">        AND (from_table = &#39;basic&#39; OR target_table = &#39;basic&#39;)</span>
<span class="s2">        AND from_table != &#39;h_link&#39;</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query_tables</span><span class="p">)</span>
        <span class="n">tables</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Column</span><span class="p">([</span><span class="s2">&quot;table&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
        <span class="c1"># the columns of basic are also valid options</span>
        <span class="n">basic_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_columns</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)[[</span><span class="s2">&quot;column_name&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">]]</span>
        <span class="n">basic_columns</span><span class="p">[</span><span class="s2">&quot;column_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span>
        <span class="n">basic_columns</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Column</span><span class="p">([</span><span class="s2">&quot;column of basic&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">basic_columns</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
        <span class="c1"># get the bundles of columns from file</span>
        <span class="n">bundle_entries</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">query_criteria_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                          <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bundle&quot;</span><span class="p">}</span>
        <span class="n">bundles</span> <span class="o">=</span> <span class="n">Table</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">bundle_entries</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                         <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">bundle_entries</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span>
                         <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bundle of basic columns&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">bundle_entries</span><span class="p">)},</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">])</span>
        <span class="c1"># get the filter names</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="s2">&quot;SELECT filtername AS name, description FROM filter&quot;</span><span class="p">)</span>
        <span class="n">filters</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Column</span><span class="p">([</span><span class="s2">&quot;filter name&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">)</span>
        <span class="c1"># vstack the four types of options</span>
        <span class="k">return</span> <span class="n">vstack</span><span class="p">([</span><span class="n">tables</span><span class="p">,</span> <span class="n">basic_columns</span><span class="p">,</span> <span class="n">bundles</span><span class="p">,</span> <span class="n">filters</span><span class="p">],</span> <span class="n">metadata_conflicts</span><span class="o">=</span><span class="s2">&quot;silent&quot;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_get_bundle_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bundle_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of columns in the preselected bundles.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bundle_name : str</span>
<span class="sd">            The possible values can be listed with `~astroquery.simbad.SimbadClass.list_votable_fields`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[simbad._Column]</span>
<span class="sd">            The list of columns corresponding to the selected bundle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">basic_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">casefold</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_columns</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)[</span><span class="s2">&quot;column_name&quot;</span><span class="p">])))</span>

        <span class="n">bundle_entries</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">query_criteria_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                          <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bundle&quot;</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">bundle_name</span> <span class="ow">in</span> <span class="n">bundle_entries</span><span class="p">:</span>
            <span class="n">bundle</span> <span class="o">=</span> <span class="n">bundle_entries</span><span class="p">[</span><span class="n">bundle_name</span><span class="p">]</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">basic_columns</span>
                       <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">bundle</span><span class="p">[</span><span class="s2">&quot;tap_startswith&quot;</span><span class="p">])]</span>
            <span class="k">if</span> <span class="s2">&quot;tap_column&quot;</span> <span class="ow">in</span> <span class="n">bundle</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">bundle</span><span class="p">[</span><span class="s2">&quot;tap_column&quot;</span><span class="p">]]</span> <span class="o">+</span> <span class="n">columns</span>
        <span class="k">return</span> <span class="n">columns</span>

    <span class="k">def</span> <span class="nf">_add_table_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add all fields of a &#39;table&#39; to the output of queries.</span>

<span class="sd">        This handles the join from the table and the naming of the columns.</span>
<span class="sd">        It only takes in account tables with an explicit link to basic. Other</span>
<span class="sd">        cases should be added manually in an ADQL query string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            name of the table to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;basic&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="n">linked_to_basic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_linked_tables</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
        <span class="c1"># list of accepted tables</span>
        <span class="n">linked_to_basic</span><span class="p">[</span><span class="s2">&quot;from_table&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">linked_to_basic</span><span class="p">[</span><span class="s2">&quot;from_table&quot;</span><span class="p">]]</span>
        <span class="c1"># the actual link to construct the join</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">linked_to_basic</span><span class="p">[</span><span class="n">linked_to_basic</span><span class="p">[</span><span class="s2">&quot;from_table&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">table</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">table</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">linked_to_basic</span><span class="p">[</span><span class="s2">&quot;from_table&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;h_link&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39; has no explicit link to &#39;basic&#39;. These cases require a custom ADQL &quot;</span>
                             <span class="s2">&quot;query to be written and called with &#39;SimbadClass.query_tap&#39;.&quot;</span><span class="p">)</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_columns</span><span class="p">(</span><span class="n">table</span><span class="p">)[</span><span class="s2">&quot;column_name&quot;</span><span class="p">])</span>

        <span class="c1"># allfluxes is the only case-dependent table</span>
        <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;allfluxes&quot;</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;oidref&quot;</span><span class="p">,</span> <span class="s2">&quot;oidbibref&quot;</span><span class="p">}]</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">column</span> <span class="k">else</span> <span class="kc">None</span>
                     <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;oidref&quot;</span><span class="p">,</span> <span class="s2">&quot;oidbibref&quot;</span><span class="p">}]</span>
            <span class="c1"># the alias is mandatory to be able to distinguish between duplicates like</span>
            <span class="c1"># mesDistance.bibcode and mesDiameter.bibcode.</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">column</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

        <span class="c1"># modify the attributes here</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span>
                                   <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">alias</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">alias</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;target_column&quot;</span><span class="p">]),</span>
                             <span class="n">_Column</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;from_column&quot;</span><span class="p">]),</span> <span class="s2">&quot;LEFT JOIN&quot;</span><span class="p">)]</span>

<div class="viewcode-block" id="SimbadClass.add_votable_fields">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.add_votable_fields">[docs]</a>
    <span class="k">def</span> <span class="nf">add_votable_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add columns to the output of a SIMBAD query.</span>

<span class="sd">        The list of possible arguments and their description for this method</span>
<span class="sd">        can be printed with `~astroquery.simbad.SimbadClass.list_votable_fields`.</span>

<span class="sd">        The methods affected by this:</span>

<span class="sd">        - `query_object`,</span>
<span class="sd">        - `query_objects`,</span>
<span class="sd">        - `query_region`,</span>
<span class="sd">        - `query_catalog`,</span>
<span class="sd">        - `query_hierarchy`,</span>
<span class="sd">        - `query_bibobj`,</span>
<span class="sd">        - `query_criteria`.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : str</span>
<span class="sd">            The arguments to be added.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; simbad = Simbad()</span>
<span class="sd">        &gt;&gt;&gt; simbad.add_votable_fields(&#39;sp_type&#39;, &#39;sp_qual&#39;, &#39;sp_bibcode&#39;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; simbad.get_votable_fields() # doctest: +REMOTE_DATA</span>
<span class="sd">        [&#39;basic.main_id&#39;, &#39;basic.ra&#39;, &#39;basic.dec&#39;, &#39;basic.coo_err_maj&#39;, &#39;basic.coo_err_min&#39;, ...</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># the legacy way of adding fluxes</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">fluxes_to_add</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">args_copy</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args_copy</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;flux_&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The votable fields &#39;flux_***(filtername)&#39; are removed and replaced &quot;</span>
                                 <span class="s2">&quot;by &#39;flux&#39; that will add all information for every filters. &quot;</span>
                                 <span class="s2">&quot;See section on filters in &quot;</span>
                                 <span class="s2">&quot;https://astroquery.readthedocs.io/en/latest/simbad/simbad_evolution.html&quot;</span>
                                 <span class="s2">&quot; to see the new ways to interact with SIMBAD&#39;s fluxes.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^flux.*\(.+\)$&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
                <span class="n">filter_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\((\w+)\)&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The notation &#39;flux(</span><span class="si">{</span><span class="n">filter_name</span><span class="si">}</span><span class="s2">)&#39; is deprecated since 0.4.8 in favor of &quot;</span>
                              <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">filter_name</span><span class="si">}</span><span class="s2">&#39;. You will see the column appearing with its new name &quot;</span>
                              <span class="s2">&quot;in the output. See section on filters in &quot;</span>
                              <span class="s2">&quot;https://astroquery.readthedocs.io/en/latest/simbad/simbad_evolution.html &quot;</span>
                              <span class="s2">&quot;to see the new ways to interact with SIMBAD&#39;s fluxes.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">fluxes_to_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filter_name</span><span class="p">)</span>
                <span class="n">args</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

        <span class="c1"># output options</span>
        <span class="n">output_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_votable_fields</span><span class="p">()</span>
        <span class="c1"># fluxes are case-dependant</span>
        <span class="n">fluxes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">output_options</span><span class="p">[</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;filter name&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
        <span class="c1"># add fluxes</span>
        <span class="n">fluxes_from_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">flux</span> <span class="k">for</span> <span class="n">flux</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">flux</span> <span class="ow">in</span> <span class="n">fluxes</span><span class="p">)</span>
        <span class="n">fluxes_to_add</span> <span class="o">+=</span> <span class="n">fluxes_from_names</span>
        <span class="k">if</span> <span class="n">fluxes_to_add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;allfluxes&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span>
                              <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;allfluxes&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">flux</span> <span class="ow">in</span> <span class="n">fluxes_to_add</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">flux</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
                    <span class="c1"># the name in the allfluxes view has a trailing underscore. This is not</span>
                    <span class="c1"># the case in the list of filter names, so we homogenize with an alias</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;allfluxes&quot;</span><span class="p">,</span> <span class="n">flux</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">flux</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;allfluxes&quot;</span><span class="p">,</span> <span class="n">flux</span><span class="p">))</span>
        <span class="c1"># remove the arguments already added</span>
        <span class="n">args</span> <span class="o">-=</span> <span class="n">fluxes_from_names</span>
        <span class="c1"># remove filters from output options</span>
        <span class="n">output_options</span> <span class="o">=</span> <span class="n">output_options</span><span class="p">[</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;filter name&quot;</span><span class="p">]</span>

        <span class="c1"># casefold args because we allow case difference for every other argument (legacy behavior)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">casefold</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
        <span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">casefold</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])))</span>
        <span class="n">basic_columns</span> <span class="o">=</span> <span class="n">output_options</span><span class="p">[</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;column of basic&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">all_tables</span> <span class="o">=</span> <span class="n">output_options</span><span class="p">[</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;table&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">bundles</span> <span class="o">=</span> <span class="n">output_options</span><span class="p">[</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bundle of basic columns&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

        <span class="c1"># Add columns from basic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">basic_columns</span><span class="p">]</span>

        <span class="c1"># Add tables</span>
        <span class="n">tables_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">all_tables</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables_to_add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_to_output</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

        <span class="c1"># Add bundles</span>
        <span class="n">bundles_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">bundle</span> <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">args</span> <span class="k">if</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">bundle</span> <span class="ow">in</span> <span class="n">bundles_to_add</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bundle_columns</span><span class="p">(</span><span class="n">bundle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])):</span>
            <span class="k">return</span>

        <span class="c1"># The other possible values are from the deprecated votable fields</span>
        <span class="n">remaining_arguments</span> <span class="o">=</span> <span class="n">args</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">votable_field</span> <span class="ow">in</span> <span class="n">remaining_arguments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">votable_field</span> <span class="ow">in</span> <span class="n">query_criteria_fields</span><span class="p">:</span>
                <span class="n">field_data</span> <span class="o">=</span> <span class="n">query_criteria_fields</span><span class="p">[</span><span class="n">votable_field</span><span class="p">]</span>
                <span class="n">field_type</span> <span class="o">=</span> <span class="n">field_data</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                <span class="c1"># some columns are still there but under a new name</span>
                <span class="k">if</span> <span class="n">field_type</span> <span class="o">==</span> <span class="s2">&quot;alias&quot;</span><span class="p">:</span>
                    <span class="n">tap_column</span> <span class="o">=</span> <span class="n">field_data</span><span class="p">[</span><span class="s2">&quot;tap_column&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">tap_column</span><span class="p">))</span>
                    <span class="n">warning_message</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">votable_field</span><span class="si">}</span><span class="s2">&#39; has been renamed &#39;</span><span class="si">{</span><span class="n">tap_column</span><span class="si">}</span><span class="s2">&#39;. You&#39;ll see it &quot;</span>
                                       <span class="s2">&quot;appearing with its new name in the output table&quot;</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warning_message</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1"># some tables are still there but under a new name</span>
                <span class="k">elif</span> <span class="n">field_type</span> <span class="o">==</span> <span class="s2">&quot;alias table&quot;</span><span class="p">:</span>
                    <span class="c1"># add all columns of the desired measurement table</span>
                    <span class="n">tap_table</span> <span class="o">=</span> <span class="n">field_data</span><span class="p">[</span><span class="s2">&quot;tap_table&quot;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_to_output</span><span class="p">(</span><span class="n">tap_table</span><span class="p">)</span>
                    <span class="n">warning_message</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">votable_field</span><span class="si">}</span><span class="s2">&#39; has been renamed &#39;</span><span class="si">{</span><span class="n">tap_table</span><span class="si">}</span><span class="s2">&#39;. You will see &quot;</span>
                                       <span class="s2">&quot;this new name in the result.&quot;</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warning_message</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1"># some tables have been moved to VizieR. This is broken since years</span>
                <span class="c1"># but they were still appearing in list_votable_fields.</span>
                <span class="k">elif</span> <span class="n">field_type</span> <span class="o">==</span> <span class="s2">&quot;historical measurement&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">votable_field</span><span class="si">}</span><span class="s2">&#39; is no longer a part of SIMBAD. It was moved &quot;</span>
                                     <span class="s2">&quot;into a separate VizieR catalog. It is possible to query &quot;</span>
                                     <span class="s2">&quot;it with the `astroquery.vizier` module.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># raise a ValueError on fields with arguments</span>
                <span class="n">_catch_deprecated_fields_with_arguments</span><span class="p">(</span><span class="n">votable_field</span><span class="p">)</span>
                <span class="c1"># or a typo</span>
                <span class="n">close_match</span> <span class="o">=</span> <span class="n">get_close_matches</span><span class="p">(</span><span class="n">votable_field</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">output_options</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]))</span>
                <span class="n">error_message</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">votable_field</span><span class="si">}</span><span class="s2">&#39; is not one of the accepted options &quot;</span>
                                 <span class="s2">&quot;which can be listed with &#39;list_votable_fields&#39;.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">close_match</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">close_matches</span> <span class="o">=</span> <span class="s2">&quot;&#39; or &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">close_match</span><span class="p">)</span>
                    <span class="n">error_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; Did you mean &#39;</span><span class="si">{</span><span class="n">close_matches</span><span class="si">}</span><span class="s2">&#39;?&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.get_votable_fields">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.get_votable_fields">[docs]</a>
    <span class="k">def</span> <span class="nf">get_votable_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Display votable fields.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span><span class="p">]</span></div>


<div class="viewcode-block" id="SimbadClass.reset_votable_fields">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.reset_votable_fields">[docs]</a>
    <span class="k">def</span> <span class="nf">reset_votable_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the output of the query_*** methods to default.</span>

<span class="sd">        They will be included in the output of the following methods:</span>

<span class="sd">        - `query_object`,</span>
<span class="sd">        - `query_objects`,</span>
<span class="sd">        - `query_region`,</span>
<span class="sd">        - `query_catalog`,</span>
<span class="sd">        - `query_hierarchy`,</span>
<span class="sd">        - `query_bibobj`,</span>
<span class="sd">        - `query_criteria`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span> <span class="o">=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                                  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">conf</span><span class="o">.</span><span class="n">default_columns</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">joins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="SimbadClass.get_field_description">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.get_field_description">[docs]</a>
    <span class="k">def</span> <span class="nf">get_field_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a description of the VOTable field.</span>

<span class="sd">        This can be replaced by the output of `~astroquery.simbad.SimbadClass.list_votable_fields`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; options = Simbad.list_votable_fields() # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; description_dimensions = options[options[&quot;name&quot;] == &quot;dimensions&quot;][&quot;description&quot;] # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; description_dimensions.data.data[0] # doctest: +REMOTE_DATA</span>
<span class="sd">        &#39;all fields related to object dimensions&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_votable_fields</span><span class="p">()</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">field_name</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">description</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


    <span class="c1"># -------------</span>
    <span class="c1"># Query methods</span>
    <span class="c1"># -------------</span>

<div class="viewcode-block" id="SimbadClass.query_object">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_object">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;verbose&quot;</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">],</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">wildcard</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query SIMBAD for the given object.</span>

<span class="sd">        Object names may also be specified with wildcards. See examples below.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        object_name : str</span>
<span class="sd">            name of object to be queried.</span>
<span class="sd">        wildcard : boolean, optional</span>
<span class="sd">            When it is set to `True` it implies that the object is specified</span>
<span class="sd">            with wildcards. This parameter will render the query case-sensitive.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        criteria : str</span>
<span class="sd">            Criteria to be applied to the query. These should be written in the ADQL</span>
<span class="sd">            syntax in a single string. See example.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            The result of the query to SIMBAD.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Get the dimensions of a specific galaxy</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; simbad = Simbad()</span>
<span class="sd">        &gt;&gt;&gt; simbad.add_votable_fields(&quot;dim&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; result = simbad.query_object(&quot;m101&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; result[&quot;main_id&quot;, &quot;ra&quot;, &quot;dec&quot;, &quot;galdim_majaxis&quot;, &quot;galdim_minaxis&quot;, &quot;galdim_bibcode&quot;] # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=1&gt;</span>
<span class="sd">        main_id         ra           dec    ... galdim_minaxis    galdim_bibcode</span>
<span class="sd">                       deg           deg    ...     arcmin</span>
<span class="sd">         object      float64       float64  ...    float32            object</span>
<span class="sd">        ------- ------------------ -------- ... -------------- -------------------</span>
<span class="sd">          M 101 210.80242916666668 54.34875 ...          20.89 2003A&amp;A...412...45P</span>

<span class="sd">        Get 5 NGC objects that are clusters of stars</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; simbad = Simbad()</span>
<span class="sd">        &gt;&gt;&gt; simbad.ROW_LIMIT = 5</span>
<span class="sd">        &gt;&gt;&gt; ngc_clusters = simbad.query_object(&quot;NGC*&quot;, wildcard=True, criteria=&quot;otype=&#39;Cl*..&#39;&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; ngc_clusters  # doctest: +REMOTE_DATA +IGNORE_OUTPUT</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">         main_id          ra        ...     coo_bibcode     matched_id</span>
<span class="sd">                         deg        ...</span>
<span class="sd">          object       float64      ...        object         object</span>
<span class="sd">        --------- ----------------- ... ------------------- ----------</span>
<span class="sd">        NGC  2024 85.42916666666667 ... 2003A&amp;A...397..177B  NGC  2024</span>
<span class="sd">        NGC  1826 76.39174999999999 ... 2011AJ....142...48W  NGC  1826</span>
<span class="sd">        NGC  2121 87.05495833333332 ... 2011AJ....142...48W  NGC  2121</span>
<span class="sd">        NGC  2019 82.98533333333333 ... 1999AcA....49..521P  NGC  2019</span>
<span class="sd">        NGC  1777             73.95 ... 2008MNRAS.389..678B  NGC  1777</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>

        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;matched_id&quot;</span><span class="p">))</span>

        <span class="n">joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">wildcard</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot; regexp(id, &#39;</span><span class="si">{</span><span class="n">_wildcard_to_regexp</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;) = 1&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;id = &#39;</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_objects">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_objects">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">,</span> <span class="s1">&#39;0.4.8&#39;</span><span class="p">],</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_names</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">wildcard</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query SIMBAD for the specified list of objects.</span>

<span class="sd">        Object names may be specified with wildcards.</span>
<span class="sd">        If one of the ``object_names`` is not found in SIMBAD, the corresponding line is</span>
<span class="sd">        returned empty in the output (see ``Giga Cluster`` in the example).</span>
<span class="sd">        In the output, the column ``user_specified_id`` is the input object name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        object_names : sequence of strs</span>
<span class="sd">            names of objects to be queried</span>
<span class="sd">        wildcard : boolean, optional</span>
<span class="sd">            When `True`, the names may have wildcards in them. Defaults to</span>
<span class="sd">            `False`.</span>
<span class="sd">        criteria : str</span>
<span class="sd">            Criteria to be applied to the query. These should be written in the ADQL</span>
<span class="sd">            syntax in a single string. See example.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        cache : Deprecated since 0.4.8. The cache is now automatically emptied at the</span>
<span class="sd">            end of the python session. It can also be emptied manually with</span>
<span class="sd">            `~astroquery.simbad.SimbadClass.clear_cache` but cannot be deactivated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            The result of the query to SIMBAD.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; clusters = Simbad.query_objects([&quot;Boss Great Wall&quot;, &quot;Great Attractor&quot;,</span>
<span class="sd">        ...                                  &quot;Giga Cluster&quot;, &quot;Coma Supercluster&quot;]) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; clusters[[&quot;main_id&quot;, &quot;ra&quot;, &quot;dec&quot;, &quot;user_specified_id&quot;]] # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=4&gt;</span>
<span class="sd">               main_id            ra     dec   user_specified_id</span>
<span class="sd">                                 deg     deg</span>
<span class="sd">                object         float64 float64       object</span>
<span class="sd">        ---------------------- ------- ------- -----------------</span>
<span class="sd">          NAME Boss Great Wall   163.0    52.0   Boss Great Wall</span>
<span class="sd">          NAME Great Attractor   158.0   -46.0   Great Attractor</span>
<span class="sd">                                    --      --      Giga Cluster</span>
<span class="sd">        NAME Coma Supercluster  170.75    23.9 Coma Supercluster</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wildcard</span><span class="p">:</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;matched_id&quot;</span><span class="p">))</span>
            <span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">))]</span>
            <span class="n">list_criteria</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;regexp(id, &#39;</span><span class="si">{</span><span class="n">_wildcard_to_regexp</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;) = 1&quot;</span>
                             <span class="k">for</span> <span class="n">object_name</span> <span class="ow">in</span> <span class="n">object_names</span><span class="p">]</span>
            <span class="n">instance_criteria</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">list_criteria</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">]</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                               <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span>

        <span class="c1"># There is a faster way to do the query if there is no wildcard: the first table</span>
        <span class="c1"># can be the uploaded one and we use a LEFT JOIN for the other ones.</span>
        <span class="n">upload</span> <span class="o">=</span> <span class="n">Table</span><span class="p">({</span><span class="s2">&quot;user_specified_id&quot;</span><span class="p">:</span> <span class="n">object_names</span><span class="p">,</span>
                        <span class="s2">&quot;object_number_id&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">object_names</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))})</span>
        <span class="n">upload_name</span> <span class="o">=</span> <span class="s2">&quot;TAP_UPLOAD.script_infos&quot;</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="n">upload_name</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">))</span>

        <span class="c1"># join on ident needs an alias in case the users want to add the votable field ident</span>
        <span class="n">left_joins</span> <span class="o">=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="n">upload_name</span><span class="p">,</span> <span class="s2">&quot;user_specified_id&quot;</span><span class="p">),</span>
                            <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">),</span> <span class="s2">&quot;LEFT JOIN&quot;</span><span class="p">,</span> <span class="s2">&quot;ident_upload&quot;</span><span class="p">),</span>
                      <span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span>
                            <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident_upload&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">),</span> <span class="s2">&quot;LEFT JOIN&quot;</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">join</span> <span class="ow">in</span> <span class="n">joins</span><span class="p">:</span>
            <span class="n">left_joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Join</span><span class="p">(</span><span class="n">join</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">join</span><span class="o">.</span><span class="n">column_left</span><span class="p">,</span>
                                    <span class="n">join</span><span class="o">.</span><span class="n">column_right</span><span class="p">,</span> <span class="s2">&quot;LEFT JOIN&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">left_joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">from_table</span><span class="o">=</span><span class="n">upload_name</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">,</span>
                           <span class="n">script_infos</span><span class="o">=</span><span class="n">upload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_region">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_region">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;equinox&quot;</span><span class="p">,</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">],</span>
                                 <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                     <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">equinox</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query SIMBAD in a cone around the specified coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinates : str or `astropy.coordinates` object</span>
<span class="sd">            The identifier or coordinates around which to query.</span>
<span class="sd">        radius : str or `~astropy.units.Quantity`</span>
<span class="sd">            the radius of the region.  Defaults to 2 arcmin.</span>
<span class="sd">        criteria : str</span>
<span class="sd">            Criteria to be applied to the query. These should be written in the ADQL</span>
<span class="sd">            syntax in a single string.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        cache : Deprecated since 0.4.8. The cache is now automatically emptied at the</span>
<span class="sd">            end of the python session. It can also be emptied manually with</span>
<span class="sd">            `~astroquery.simbad.SimbadClass.clear_cache` but cannot be deactivated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            The result of the query to SIMBAD.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Look for largest galaxies in two cones</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; from astropy.coordinates import SkyCoord</span>
<span class="sd">        &gt;&gt;&gt; simbad = Simbad()</span>
<span class="sd">        &gt;&gt;&gt; simbad.ROW_LIMIT = 5</span>
<span class="sd">        &gt;&gt;&gt; simbad.add_votable_fields(&quot;otype&quot;, &quot;dim&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; coordinates = SkyCoord([SkyCoord(186.6, 12.7, unit=(&quot;deg&quot;, &quot;deg&quot;)),</span>
<span class="sd">        ...                         SkyCoord(170.75, 23.9, unit=(&quot;deg&quot;, &quot;deg&quot;))])</span>
<span class="sd">        &gt;&gt;&gt; result = simbad.query_region(coordinates, radius=&quot;2d5m&quot;,</span>
<span class="sd">        ...                              criteria=&quot;otype = &#39;Galaxy..&#39; AND galdim_majaxis&gt;8.5&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; result.sort(&quot;galdim_majaxis&quot;, reverse=True) # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; result[&quot;main_id&quot;, &quot;otype&quot;, &quot;galdim_majaxis&quot;] # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">          main_id    otype  galdim_majaxis</span>
<span class="sd">                                arcmin</span>
<span class="sd">           object    object    float32</span>
<span class="sd">        ------------ ------ --------------</span>
<span class="sd">        LEDA   41362    GiC           11.0</span>
<span class="sd">               M  86    GiG          10.47</span>
<span class="sd">        LEDA   40917    AG?           10.3</span>
<span class="sd">               M  87    AGN           9.12</span>
<span class="sd">           NGC  4438    LIN           8.91</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        It is very inefficient to call this within a loop. Creating an `~astropy.coordinates.SkyCoord`</span>
<span class="sd">        object with a list of coordinates will be way faster.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># this message is specifically for deprecated use of &#39;None&#39; to mean &#39;Default&#39;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The cone radius must be specified as an angle-equivalent quantity&quot;</span><span class="p">)</span>

        <span class="n">center</span> <span class="o">=</span> <span class="n">commons</span><span class="o">.</span><span class="n">parse_coordinates</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="s2">&quot;icrs&quot;</span><span class="p">)</span>

        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">isscalar</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">Angle</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CONTAINS(POINT(&#39;ICRS&#39;, basic.ra, basic.dec), &quot;</span>
                                     <span class="sa">f</span><span class="s2">&quot;CIRCLE(&#39;ICRS&#39;, </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="si">}</span><span class="s2">, &quot;</span>
                                     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">)) = 1&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                               <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span>

        <span class="c1"># from uploadLimit in SIMBAD&#39;s capabilities</span>
        <span class="c1"># http://simbad.cds.unistra.fr/simbad/sim-tap/capabilities</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">uploadlimit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;query_region&#39; can process up to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">uploadlimit</span><span class="si">}</span><span class="s2"> &quot;</span>
                             <span class="s2">&quot;centers. For larger queries, split your centers list.&quot;</span><span class="p">)</span>

        <span class="c1"># `radius` as `str` is iterable, but contains only one value.</span>
        <span class="k">if</span> <span class="n">isiterable</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mismatch between radii of length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot; and center coordinates of length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">Angle</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">radius</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">Angle</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>

        <span class="c1"># for small number of centers, not using the upload method is faster</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">300</span><span class="p">:</span>
            <span class="n">cone_criteria</span> <span class="o">=</span> <span class="p">[(</span><span class="sa">f</span><span class="s2">&quot;CONTAINS(POINT(&#39;ICRS&#39;, basic.ra, basic.dec), CIRCLE(&#39;ICRS&#39;, &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">)) = 1 &quot;</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">)]</span>

            <span class="n">cone_criteria</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="s1">&#39;OR &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cone_criteria</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cone_criteria</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                               <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span>

        <span class="c1"># for longer centers list, we use a TAP upload</span>
        <span class="n">upload_centers</span> <span class="o">=</span> <span class="n">Table</span><span class="p">({</span><span class="s2">&quot;ra&quot;</span><span class="p">:</span> <span class="n">center</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="s2">&quot;dec&quot;</span><span class="p">:</span> <span class="n">center</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
                                <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="n">radius</span><span class="p">})</span>
        <span class="n">sub_query</span> <span class="o">=</span> <span class="s2">&quot;(SELECT ra, dec, radius FROM TAP_UPLOAD.centers) AS centers&quot;</span>
        <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;CONTAINS(POINT(&#39;ICRS&#39;, basic.ra, basic.dec), CIRCLE&quot;</span>
                                 <span class="s2">&quot;(&#39;ICRS&#39;, centers.ra, centers.dec, centers.radius)) = 1 &quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">from_table</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sub_query</span><span class="si">}</span><span class="s2">, basic&quot;</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="n">upload_centers</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_catalog">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_catalog">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">,</span> <span class="s1">&#39;0.4.8&#39;</span><span class="p">],</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query a whole catalog.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        catalog : str</span>
<span class="sd">            The name of the catalog. This is case-dependant.</span>
<span class="sd">        criteria : str</span>
<span class="sd">            Criteria to be applied to the query. These should be written in the ADQL</span>
<span class="sd">            syntax in a single string. See example.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        cache : Deprecated since 0.4.8. The cache is now automatically emptied at the</span>
<span class="sd">            end of the python session. It can also be emptied manually with</span>
<span class="sd">            `~astroquery.simbad.SimbadClass.clear_cache` but cannot be deactivated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            The result of the query to SIMBAD.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; simbad = Simbad()</span>
<span class="sd">        &gt;&gt;&gt; simbad.ROW_LIMIT = 5</span>
<span class="sd">        &gt;&gt;&gt; simbad.query_catalog(&quot;GSC&quot;, criteria=&quot;pmra &gt; 50 and pmra &lt; 100&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">            main_id            ra       ...     coo_bibcode        catalog_id</span>
<span class="sd">                              deg       ...</span>
<span class="sd">             object         float64     ...        object            object</span>
<span class="sd">        --------------- --------------- ... ------------------- ---------------</span>
<span class="sd">              HD  26053  61.84326890626 ... 2020yCat.1350....0G GSC 04725-00973</span>
<span class="sd">        TYC 8454-1081-1 345.11163189562 ... 2020yCat.1350....0G GSC 08454-01081</span>
<span class="sd">              HD  10158  24.86286094434 ... 2020yCat.1350....0G GSC 00624-00340</span>
<span class="sd">            CD-22  1862  73.17988827324 ... 2020yCat.1350....0G GSC 05911-00222</span>
<span class="sd">            BD+02  4434 327.90220788982 ... 2020yCat.1350....0G GSC 00548-00194</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Catalogs can be very large. Configuring ``SimbadClass.ROW_LIMIT`` allows to</span>
<span class="sd">        restrict the output.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>

        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog_id&quot;</span><span class="p">))</span>

        <span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ident&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">))]</span>

        <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;id LIKE &#39;</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2"> %&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_hierarchy">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_hierarchy">[docs]</a>
    <span class="k">def</span> <span class="nf">query_hierarchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">hierarchy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                        <span class="n">detailed_hierarchy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query either the parents or the children of the object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            name of the object</span>
<span class="sd">        hierarchy : str</span>
<span class="sd">            Can take the values &quot;parents&quot; to return the parents of the object (ex: a</span>
<span class="sd">            galaxy cluster is a parent of a galaxy), the value &quot;children&quot; to return</span>
<span class="sd">            the children of an object (ex: stars can be children of a globular cluster),</span>
<span class="sd">            or the value &quot;siblings&quot; to return the object that share a parent with the</span>
<span class="sd">            given one (ex: the stars of an open cluster are all siblings).</span>
<span class="sd">        detailed_hierarchy : bool</span>
<span class="sd">            Whether to add the two extra columns &#39;hierarchy_bibcode&#39; that gives the</span>
<span class="sd">            article in which the hierarchy link is mentioned, and</span>
<span class="sd">            &#39;membership_certainty&#39;. membership_certainty is an integer that reflects the</span>
<span class="sd">            certainty of the hierarchy link according to the authors. Ranges between 0</span>
<span class="sd">            and 100 where 100 means that the authors were certain of the classification.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        criteria : str</span>
<span class="sd">            Criteria to be applied to the query. These should be written in the ADQL</span>
<span class="sd">            syntax in a single string. See example.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            Query results table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; parent = Simbad.query_hierarchy(&quot;2MASS J18511048-0615470&quot;,</span>
<span class="sd">        ...                                 detailed_hierarchy=False,</span>
<span class="sd">        ...                                 hierarchy=&quot;parents&quot;)  # doctest: +REMOTE_DATA</span>
<span class="sd">        &gt;&gt;&gt; parent[[&quot;main_id&quot;, &quot;ra&quot;, &quot;dec&quot;]] # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=1&gt;</span>
<span class="sd">         main_id     ra     dec</span>
<span class="sd">                    deg     deg</span>
<span class="sd">          object  float64 float64</span>
<span class="sd">        --------- ------- -------</span>
<span class="sd">        NGC  6705 282.766  -6.272</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>

        <span class="n">sub_query</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;(SELECT oidref FROM ident &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;WHERE id = &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;) AS name&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">detailed_hierarchy</span><span class="p">:</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="s2">&quot;link_bibcode&quot;</span><span class="p">,</span> <span class="s2">&quot;hierarchy_bibcode&quot;</span><span class="p">))</span>
            <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="s2">&quot;membership&quot;</span><span class="p">,</span> <span class="s2">&quot;membership_certainty&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hierarchy</span> <span class="o">==</span> <span class="s2">&quot;parents&quot;</span><span class="p">:</span>
            <span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="s2">&quot;parent&quot;</span><span class="p">))]</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;h_link.child = name.oidref&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">hierarchy</span> <span class="o">==</span> <span class="s2">&quot;children&quot;</span><span class="p">:</span>
            <span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="p">))]</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;h_link.parent = name.oidref&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">hierarchy</span> <span class="o">==</span> <span class="s2">&quot;siblings&quot;</span><span class="p">:</span>
            <span class="n">sub_query</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;(SELECT DISTINCT basic.oid FROM &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sub_query</span><span class="si">}</span><span class="s2">, basic JOIN h_link ON basic.oid = h_link.parent &quot;</span>
                         <span class="s2">&quot;WHERE h_link.child = name.oidref) AS parents&quot;</span><span class="p">)</span>
            <span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;h_link&quot;</span><span class="p">,</span> <span class="s2">&quot;child&quot;</span><span class="p">))]</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;h_link.parent = parents.oid&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;hierarchy&#39; can only take the values &#39;parents&#39;, &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;&#39;siblings&#39;, or &#39;children&#39;. Got &#39;</span><span class="si">{</span><span class="n">hierarchy</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">from_table</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sub_query</span><span class="si">}</span><span class="s2">, basic&quot;</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_bibobj">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_bibobj">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;verbose&quot;</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">],</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_bibobj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bibcode</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query all the objects mentioned in an article.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bibcode : str</span>
<span class="sd">            the bibcode of the article</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            Query results table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>

        <span class="n">joins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;has_ref&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;has_ref&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">)),</span>
                  <span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;ref&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;has_ref&quot;</span><span class="p">,</span> <span class="s2">&quot;oidbibref&quot;</span><span class="p">),</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ref&quot;</span><span class="p">,</span> <span class="s2">&quot;oidbib&quot;</span><span class="p">))]</span>

        <span class="n">columns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;ref&quot;</span><span class="p">,</span> <span class="s2">&quot;bibcode&quot;</span><span class="p">),</span>
                    <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;has_ref&quot;</span><span class="p">,</span> <span class="s2">&quot;obj_freq&quot;</span><span class="p">)]</span>

        <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bibcode = &#39;</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">bibcode</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_bibcode">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_bibcode">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">,</span> <span class="s1">&#39;0.4.8&#39;</span><span class="p">],</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_bibcode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bibcode</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">wildcard</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">abstract</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query the references corresponding to a given bibcode.</span>

<span class="sd">        Wildcards may be used to specify bibcodes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bibcode : str</span>
<span class="sd">            The bibcode of the article to be queried</span>
<span class="sd">        wildcard : bool, defaults to False</span>
<span class="sd">            When it is set to `True` it implies that the object is specified</span>
<span class="sd">            with wildcards.</span>
<span class="sd">        abstract : bool, defaults to False</span>
<span class="sd">            When this is set to `True`, the abstract of the article is also included</span>
<span class="sd">            to the result.</span>
<span class="sd">        criteria : str</span>
<span class="sd">            Criteria to be applied to the query. These should be written in the ADQL</span>
<span class="sd">            syntax in a single string. See example.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        cache : Deprecated since 0.4.8. The cache is now automatically emptied at the</span>
<span class="sd">            end of the python session. It can also be emptied manually with</span>
<span class="sd">            `~astroquery.simbad.SimbadClass.clear_cache` but cannot be deactivated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            Query results table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; simbad = Simbad()</span>
<span class="sd">        &gt;&gt;&gt; simbad.ROW_LIMIT = 5</span>
<span class="sd">        &gt;&gt;&gt; simbad.query_bibcode(&quot;2016PhRvL.*&quot;, wildcard=True,</span>
<span class="sd">        ...                      criteria=&quot;title LIKE &#39;%gravitational wave%coalescence.&#39;&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=1&gt;</span>
<span class="sd">              bibcode                    doi               journal ... volume  year</span>
<span class="sd">               object                   object              object ... int32  int16</span>
<span class="sd">        ------------------- ------------------------------ ------- ... ------ -----</span>
<span class="sd">        2016PhRvL.116x1103A 10.1103/PhysRevLett.116.241103   PhRvL ...    116  2016</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ref_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bibcode&quot;</span><span class="p">,</span> <span class="s2">&quot;doi&quot;</span><span class="p">,</span> <span class="s2">&quot;journal&quot;</span><span class="p">,</span> <span class="s2">&quot;nbobject&quot;</span><span class="p">,</span> <span class="s2">&quot;page&quot;</span><span class="p">,</span> <span class="s2">&quot;last_page&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]</span>
        <span class="c1"># abstract option</span>
        <span class="k">if</span> <span class="n">abstract</span><span class="p">:</span>
            <span class="n">ref_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;abstract&quot;</span><span class="p">)</span>
        <span class="n">ref_columns</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ref_columns</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># take row limit</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT TOP </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ref_columns</span><span class="si">}</span><span class="s2"> FROM ref WHERE &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT </span><span class="si">{</span><span class="n">ref_columns</span><span class="si">}</span><span class="s2"> FROM ref WHERE &quot;</span>

        <span class="k">if</span> <span class="n">wildcard</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;regexp(lowercase(bibcode), &#39;</span><span class="si">{</span><span class="n">_wildcard_to_regexp</span><span class="p">(</span><span class="n">bibcode</span><span class="o">.</span><span class="n">casefold</span><span class="p">())</span><span class="si">}</span><span class="s2">&#39;) = 1&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;bibcode = &#39;</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">bibcode</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span>

        <span class="k">if</span> <span class="n">criteria</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; AND </span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; ORDER BY bibcode&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_objectids">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_objectids">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">([</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="s2">&quot;cache&quot;</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
                                 <span class="n">since</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">,</span> <span class="s1">&#39;0.4.8&#39;</span><span class="p">],</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">query_objectids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query SIMBAD with an object name.</span>

<span class="sd">        This returns a table of all names associated with that object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        object_name : str</span>
<span class="sd">            name of object to be queried</span>
<span class="sd">        criteria : str</span>
<span class="sd">            an additional criteria to constrain the result. As the output of this</span>
<span class="sd">            method has only one column, these criteria can only be imposed on</span>
<span class="sd">            the column ``ident.id``.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        cache : Deprecated since 0.4.8. The cache is now automatically emptied at the</span>
<span class="sd">            end of the python session. It can also be emptied manually with</span>
<span class="sd">            `~astroquery.simbad.SimbadClass.clear_cache` but cannot be deactivated.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            The result of the query to SIMBAD.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Get all the names of the Bubble Nebula</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.query_objectids(&quot;bubble nebula&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=8&gt;</span>
<span class="sd">                      id</span>
<span class="sd">                    object</span>
<span class="sd">        ------------------------------</span>
<span class="sd">        [ABB2014] WISE G112.212+00.229</span>
<span class="sd">                             LBN   548</span>
<span class="sd">                             NGC  7635</span>
<span class="sd">                             SH  2-162</span>
<span class="sd">                  [KC97c] G112.2+00.2b</span>
<span class="sd">                 [L89b] 112.237+00.226</span>
<span class="sd">                    GRS G112.22 +00.22</span>
<span class="sd">                    NAME Bubble Nebula</span>

<span class="sd">        Get the NGC name of M101</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.query_objectids(&quot;m101&quot;, criteria=&quot;ident.id LIKE &#39;NGC%&#39;&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=1&gt;</span>
<span class="sd">            id</span>
<span class="sd">          object</span>
<span class="sd">        ---------</span>
<span class="sd">        NGC  5457</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;SELECT ident.id FROM ident AS id_typed JOIN ident USING(oidref)&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;WHERE id_typed.id = &#39;</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">criteria</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; AND </span><span class="si">{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_criteria">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_criteria">[docs]</a>
    <span class="nd">@deprecated</span><span class="p">(</span><span class="n">since</span><span class="o">=</span><span class="s2">&quot;v0.4.8&quot;</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&#39;query_criteria&#39; is deprecated. It uses the former sim-script &quot;</span>
                         <span class="s2">&quot;(SIMBAD specific) syntax &quot;</span>
                         <span class="s2">&quot;(see https://simbad.cds.unistra.fr/simbad/sim-fsam). &quot;</span>
                         <span class="s2">&quot;Possible replacements are the &#39;criteria&#39; argument in the other &quot;</span>
                         <span class="s2">&quot;query methods or custom &#39;query_tap&#39; queries. &quot;</span>
                         <span class="s2">&quot;These two replacements use the standard ADQL syntax.&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">query_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query SIMBAD based on any criteria [deprecated].</span>

<span class="sd">        This method is deprecated as it uses the former SIMBAD-specific sim-script syntax.</span>
<span class="sd">        There are two possible replacements that have been added with astroquery v0.4.8</span>
<span class="sd">        and that use the standard ADQL syntax. See the examples section.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args:</span>
<span class="sd">            String arguments passed directly to SIMBAD&#39;s script</span>
<span class="sd">            (e.g., &#39;region(box, GAL, 10.5 -10.5, 0.5d 0.5d)&#39;)</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        kwargs:</span>
<span class="sd">            Keyword / value pairs passed to SIMBAD&#39;s script engine</span>
<span class="sd">            (e.g., {&#39;otype&#39;=&#39;SNR&#39;} will be rendered as otype=SNR)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        table : `~astropy.table.Table`</span>
<span class="sd">            Query results table</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Can be replaced by the ``criteria`` argument that was added in the</span>
<span class="sd">        other query_*** methods</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad(ROW_LIMIT=5).query_region(&#39;M1&#39;, &#39;2d&#39;, criteria=&quot;otype=&#39;G..&#39;&quot;) # doctest: +REMOTE_DATA +IGNORE_OUTPUT</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">          main_id            ra        ... coo_wavelength     coo_bibcode</span>
<span class="sd">                            deg        ...</span>
<span class="sd">           object         float64      ...      str1             object</span>
<span class="sd">        ------------ ----------------- ... -------------- -------------------</span>
<span class="sd">        LEDA  136099 85.48166666666667 ...                1996A&amp;AS..117....1S</span>
<span class="sd">        LEDA  136047 83.66958333333332 ...                1996A&amp;AS..117....1S</span>
<span class="sd">        LEDA  136057 84.64499999999998 ...                1996A&amp;AS..117....1S</span>
<span class="sd">        LEDA 1630996 83.99208333333333 ...              O 2003A&amp;A...412...45P</span>
<span class="sd">          2MFGC 4574 84.37534166666669 ...              I 2006AJ....131.1163S</span>

<span class="sd">        Or by custom-written ADQL queries</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.query_tap(&quot;SELECT TOP 5 main_id, sp_type&quot;</span>
<span class="sd">        ...                  &quot; FROM basic WHERE sp_type &lt; &#39;F3&#39;&quot;) # doctest: +REMOTE_DATA +IGNORE_OUTPUT</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">          main_id   sp_type</span>
<span class="sd">           object    object</span>
<span class="sd">        ----------- -------</span>
<span class="sd">         HD  24033B     (A)</span>
<span class="sd">         HD  70218B     (A)</span>
<span class="sd">         HD 128284B   (A/F)</span>
<span class="sd">        CD-34  5319   (A/F)</span>
<span class="sd">          HD  80593   (A0)V</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_query_parameters</span><span class="p">()</span>
        <span class="n">list_kwargs</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">argument</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">added_criteria</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">CriteriaTranslator</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39; &amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">list_kwargs</span><span class="p">)))</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">instance_criteria</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">added_criteria</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;otypes.&quot;</span> <span class="ow">in</span> <span class="n">added_criteria</span><span class="p">:</span>
            <span class="n">joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;otypes&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span>
                               <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;otypes&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="s2">&quot;allfluxes.&quot;</span> <span class="ow">in</span> <span class="n">added_criteria</span><span class="p">:</span>
            <span class="n">joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_Join</span><span class="p">(</span><span class="s2">&quot;allfluxes&quot;</span><span class="p">,</span> <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="s2">&quot;oid&quot;</span><span class="p">),</span>
                               <span class="n">_Column</span><span class="p">(</span><span class="s2">&quot;allfluxes&quot;</span><span class="p">,</span> <span class="s2">&quot;oidref&quot;</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">instance_criteria</span><span class="p">,</span>
                           <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.list_tables">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.list_tables">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">(</span><span class="s2">&quot;get_adql&quot;</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;get_query_payload&quot;</span><span class="p">,</span>
                                 <span class="n">since</span><span class="o">=</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">list_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the names and descriptions of the tables in SIMBAD.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        get_adql : bool, optional</span>
<span class="sd">            Deprecated since &#39;0.4.8&#39;. This is replaced by get_query_payload that contain</span>
<span class="sd">            more information than just the ADQL string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~astropy.table.Table`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;SELECT table_name, description&quot;</span>
                 <span class="s2">&quot; FROM TAP_SCHEMA.tables&quot;</span>
                 <span class="s2">&quot; WHERE schema_name = &#39;public&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.list_columns">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.list_columns">[docs]</a>
    <span class="nd">@deprecated_renamed_argument</span><span class="p">(</span><span class="s2">&quot;get_adql&quot;</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="s2">&quot;get_query_payload&quot;</span><span class="p">,</span>
                                 <span class="n">since</span><span class="o">=</span><span class="s1">&#39;0.4.8&#39;</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">list_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tables</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">keyword</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of SIMBAD columns.</span>

<span class="sd">        Add tables names to restrict to some tables. Call the function without</span>
<span class="sd">        any parameter to get all columns names from all tables. The keyword argument</span>
<span class="sd">        looks for columns in the selected SIMBAD tables that contain the</span>
<span class="sd">        given keyword. The keyword search is not case-sensitive.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *tables : str, optional</span>
<span class="sd">            Add tables names as strings to restrict to these tables columns.</span>
<span class="sd">            This is not case-sensitive.</span>
<span class="sd">        keyword : str, optional</span>
<span class="sd">            A keyword to look for in column names, table names, or descriptions.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        get_adql : bool, optional</span>
<span class="sd">            Deprecated since &#39;0.4.8&#39;. This is replaced by get_query_payload that contain</span>
<span class="sd">            more information than just the ADQL string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~astropy.table.Table`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.list_columns(&quot;ids&quot;, &quot;ident&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=4&gt;</span>
<span class="sd">        table_name column_name datatype ...  unit    ucd</span>
<span class="sd">          object      object    object  ... object  object</span>
<span class="sd">        ---------- ----------- -------- ... ------ -------</span>
<span class="sd">             ident          id  VARCHAR ...        meta.id</span>
<span class="sd">             ident      oidref   BIGINT ...</span>
<span class="sd">               ids         ids  VARCHAR ...        meta.id</span>
<span class="sd">               ids      oidref   BIGINT ...</span>


<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.list_columns(keyword=&quot;filter&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">         table_name column_name   datatype  ...  unit           ucd</span>
<span class="sd">           object      object      object   ... object         object</span>
<span class="sd">        ----------- ----------- ----------- ... ------ ----------------------</span>
<span class="sd">             filter description UNICODECHAR ...        meta.note;instr.filter</span>
<span class="sd">             filter  filtername     VARCHAR ...                  instr.filter</span>
<span class="sd">             filter        unit     VARCHAR ...                     meta.unit</span>
<span class="sd">               flux      filter     VARCHAR ...                  instr.filter</span>
<span class="sd">        mesDiameter      filter        CHAR ...                  instr.filter</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.list_columns(&quot;basic&quot;, keyword=&quot;object&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=4&gt;</span>
<span class="sd">        table_name column_name datatype ...  unit          ucd</span>
<span class="sd">          object      object    object  ... object        object</span>
<span class="sd">        ---------- ----------- -------- ... ------ -------------------</span>
<span class="sd">             basic     main_id  VARCHAR ...          meta.id;meta.main</span>
<span class="sd">             basic   otype_txt  VARCHAR ...                  src.class</span>
<span class="sd">             basic         oid   BIGINT ...        meta.record;meta.id</span>
<span class="sd">             basic       otype  VARCHAR ...                  src.class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;SELECT table_name, column_name, datatype, description, unit, ucd&quot;</span>
                 <span class="s2">&quot; FROM TAP_SCHEMA.columns&quot;</span>
                 <span class="s2">&quot; WHERE table_name NOT LIKE &#39;TAP_SCHEMA.%&#39;&quot;</span><span class="p">)</span>
        <span class="c1"># select the tables</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">casefold</span><span class="p">,</span> <span class="n">tables</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; AND LOWERCASE(table_name) = &#39;</span><span class="si">{</span><span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; AND LOWERCASE(table_name) IN </span><span class="si">{</span><span class="n">tables</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># add the keyword condition</span>
        <span class="k">if</span> <span class="n">keyword</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;LIKE LOWERCASE(&#39;%</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span><span class="si">}</span><span class="s2">%&#39;)&quot;</span>
            <span class="n">query</span> <span class="o">+=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot; AND ( (LOWERCASE(column_name) </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2">)&quot;</span>
                      <span class="sa">f</span><span class="s2">&quot; OR (LOWERCASE(description) </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2">)&quot;</span>
                      <span class="sa">f</span><span class="s2">&quot; OR (LOWERCASE(table_name) </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2">))&quot;</span><span class="p">)</span>
        <span class="n">query</span> <span class="o">+=</span> <span class="s2">&quot; ORDER BY table_name, principal DESC, column_name&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.list_linked_tables">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.list_linked_tables">[docs]</a>
    <span class="k">def</span> <span class="nf">list_linked_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Expose the tables that can be non-obviously linked with the given table.</span>

<span class="sd">        This list contains only the links where the column names are not the same in the</span>
<span class="sd">        two tables. For example every ``oidref`` column of any table can be joined with</span>
<span class="sd">        any other ``oidref``. The same goes for every ``otype`` column even if this is not</span>
<span class="sd">        returned by this method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str</span>
<span class="sd">            One of SIMBAD&#39;s tables name</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~astropy.table.Table`</span>
<span class="sd">            The information necessary to join the given table to an other.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.list_linked_tables(&quot;otypes&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=2&gt;</span>
<span class="sd">        from_table from_column target_table target_column</span>
<span class="sd">          object      object      object        object</span>
<span class="sd">        ---------- ----------- ------------ -------------</span>
<span class="sd">          otypedef       otype       otypes         otype</span>
<span class="sd">            otypes      oidref        basic           oid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;SELECT from_table, from_column, target_table, target_column&quot;</span>
                 <span class="s2">&quot; FROM TAP_SCHEMA.key_columns JOIN TAP_SCHEMA.keys USING (key_id)&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot; WHERE (from_table = &#39;</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot; OR (target_table = &#39;</span><span class="si">{</span><span class="n">_adql_parameter</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">)</span></div>


<div class="viewcode-block" id="SimbadClass.query_tap">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.query_tap">[docs]</a>
    <span class="k">def</span> <span class="nf">query_tap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">uploads</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query SIMBAD TAP service.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query : str</span>
<span class="sd">            A string containing the query written in the</span>
<span class="sd">            Astronomical Data Query Language (ADQL).</span>
<span class="sd">        maxrec : int, default: 10000</span>
<span class="sd">            The number of records to be returned. Its maximum value is given by</span>
<span class="sd">            `~astroquery.simbad.SimbadClass.hardlimit`.</span>
<span class="sd">        uploads : `~astropy.table.Table` | `~astropy.io.votable.tree.VOTableFile` | `~pyvo.dal.DALResults`</span>
<span class="sd">            Any number of local tables to be used in the *query*. In the *query*, these tables</span>
<span class="sd">            are referred as *TAP_UPLOAD.table_alias* where *TAP_UPLOAD* is imposed and *table_alias*</span>
<span class="sd">            is the keyword name you chose. The maximum number of lines for the uploaded tables is 200000.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~astropy.table.Table`</span>
<span class="sd">            The response returned by Simbad.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A TAP (Table Access Protocol) service allows to query data tables with</span>
<span class="sd">        queries written in ADQL (Astronomical Data Query Language), a flavor</span>
<span class="sd">        of the more general SQL (Structured Query Language).</span>
<span class="sd">        For more documentation about writing ADQL queries, you can read its official</span>
<span class="sd">        documentation (`ADQL documentation &lt;https://ivoa.net/documents/ADQL/index.html&gt;`__)</span>
<span class="sd">        or the `Simbad ADQL cheat sheet &lt;http://simbad.cds.unistra.fr/simbad/tap/help/adqlHelp.html&gt;`__.</span>
<span class="sd">        See also: a `graphic representation of Simbad&#39;s tables and their relations</span>
<span class="sd">        &lt;http://simbad.cds.unistra.fr/simbad/tap/tapsearch.html&gt;`__.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        list_tables : The list of SIMBAD&#39;s tables.</span>
<span class="sd">        list_columns : SIMBAD&#39;s columns list, can be restricted to some tables and some keyword.</span>
<span class="sd">        list_linked_tables : Given a table, expose non-obvious possible joins with other tables.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        To see the five oldest papers referenced in SIMBAD</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.query_tap(&quot;SELECT top 5 bibcode, title &quot;</span>
<span class="sd">        ...                  &quot;FROM ref ORDER BY bibcode&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=5&gt;</span>
<span class="sd">              bibcode       ...</span>
<span class="sd">               object       ...</span>
<span class="sd">        ------------------- ...</span>
<span class="sd">        1850CDT..1784..227M ...</span>
<span class="sd">        1857AN.....45...89S ...</span>
<span class="sd">        1861MNRAS..21...68B ...</span>
<span class="sd">        1874MNRAS..34...75S ...</span>
<span class="sd">        1877AN.....89...13W ...</span>

<span class="sd">        Get the type for a list of objects</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; Simbad.query_tap(&quot;SELECT main_id, otype&quot;</span>
<span class="sd">        ...                  &quot; FROM basic WHERE main_id IN (&#39;m10&#39;, &#39;m13&#39;)&quot;) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=2&gt;</span>
<span class="sd">        main_id otype</span>
<span class="sd">         object object</span>
<span class="sd">        ------- ------</span>
<span class="sd">          M  10    GlC</span>
<span class="sd">          M  13    GlC</span>

<span class="sd">        Upload a table to use in a query</span>

<span class="sd">        &gt;&gt;&gt; from astroquery.simbad import Simbad</span>
<span class="sd">        &gt;&gt;&gt; from astropy.table import Table</span>
<span class="sd">        &gt;&gt;&gt; letters_table = Table([[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]], names=[&quot;alphabet&quot;])</span>
<span class="sd">        &gt;&gt;&gt; Simbad.query_tap(&quot;SELECT TAP_UPLOAD.my_table_name.* from TAP_UPLOAD.my_table_name&quot;,</span>
<span class="sd">        ...                  my_table_name=letters_table) # doctest: +REMOTE_DATA</span>
<span class="sd">        &lt;Table length=3&gt;</span>
<span class="sd">        alphabet</span>
<span class="sd">          str1</span>
<span class="sd">        --------</span>
<span class="sd">               a</span>
<span class="sd">               b</span>
<span class="sd">               c</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">maxrec</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardlimit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The maximum number of records cannot exceed </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hardlimit</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Query string contains an odd number of single quotes.&quot;</span>
                             <span class="s2">&quot; Escape the unpaired single quote by doubling it.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;ex: &#39;Barnard&#39;s galaxy&#39; -&gt; &#39;Barnard&#39;&#39;s galaxy&#39;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_query_payload</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">TAPQuery</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIMBAD_URL</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">,</span> <span class="n">uploads</span><span class="o">=</span><span class="n">uploads</span><span class="p">))</span>
        <span class="c1"># without uploads we call the version with cache</span>
        <span class="k">if</span> <span class="n">uploads</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="k">return</span> <span class="n">_cached_query_tap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tap</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">)</span>
        <span class="c1"># with uploads it has to be without cache</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">,</span> <span class="n">uploads</span><span class="o">=</span><span class="n">uploads</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span></div>


<div class="viewcode-block" id="SimbadClass.clear_cache">
<a class="viewcode-back" href="../../../api/astroquery.simbad.SimbadClass.html#astroquery.simbad.SimbadClass.clear_cache">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the cache of SIMBAD.&quot;&quot;&quot;</span>
        <span class="n">_cached_query_tap</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span></div>


    <span class="c1"># -----------------------------</span>
    <span class="c1"># Utility methods for query TAP</span>
    <span class="c1"># -----------------------------</span>

    <span class="k">def</span> <span class="nf">_get_query_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current building blocks of an ADQL query.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns_in_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">joins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">joins</span><span class="p">,</span> <span class="n">criteria</span><span class="p">,</span> <span class="n">from_table</span><span class="o">=</span><span class="s2">&quot;basic&quot;</span><span class="p">,</span> <span class="n">distinct</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">uploads</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate an ADQL string from the given query parameters and executes the query.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        top : int</span>
<span class="sd">            number of lines to be returned</span>
<span class="sd">        columns : List[SimbadClass.Column]</span>
<span class="sd">            The list of columns to be included in the output.</span>
<span class="sd">        joins : List[SimbadClass.Join]</span>
<span class="sd">            The list of joins to be made with basic.</span>
<span class="sd">        criteria : List[str]</span>
<span class="sd">            A list of strings. These criteria will be joined</span>
<span class="sd">            with an AND clause.</span>
<span class="sd">        from_table : str, optional</span>
<span class="sd">            The table after &#39;FROM&#39; in the ADQL string. Defaults to &quot;basic&quot;.</span>
<span class="sd">        distinct : bool, optional</span>
<span class="sd">            Whether to add the DISTINCT instruction to the query.</span>
<span class="sd">        get_query_payload : bool, optional</span>
<span class="sd">            When set to `True` the method returns the HTTP request parameters without</span>
<span class="sd">            querying SIMBAD. The ADQL string is in the &#39;QUERY&#39; key of the payload.</span>
<span class="sd">            Defaults to `False`.</span>
<span class="sd">        uploads : `~astropy.table.Table`</span>
<span class="sd">            Any number of local tables to be used in the *query*. In the *query*, these tables</span>
<span class="sd">            are referred as *TAP_UPLOAD.table_alias* where *TAP_UPLOAD* is imposed and *table_alias*</span>
<span class="sd">            is the keyword name you chose. The maximum number of lines for the uploaded tables is 200000.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~astropy.table.Table`</span>
<span class="sd">            The result of the query to SIMBAD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distinct_results</span> <span class="o">=</span> <span class="s2">&quot; DISTINCT&quot;</span> <span class="k">if</span> <span class="n">distinct</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">top_part</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; TOP </span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">top</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># columns</span>
        <span class="n">input_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.&quot;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; AS &quot;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">alias</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">if</span> <span class="n">column</span><span class="o">.</span><span class="n">alias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                         <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.&quot;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
        <span class="c1"># remove possible duplicates</span>
        <span class="n">unique_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="p">[</span><span class="n">unique_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">input_columns</span> <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_columns</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">unique_columns</span><span class="p">)</span>
        <span class="c1"># selecting all columns is the only case where this should not be a string</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;*&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">)</span>

        <span class="c1"># joins</span>
        <span class="k">if</span> <span class="n">joins</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">join</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unique_joins</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="p">[</span><span class="n">unique_joins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">join</span><span class="p">)</span> <span class="k">for</span> <span class="n">join</span> <span class="ow">in</span> <span class="n">joins</span> <span class="k">if</span> <span class="n">join</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_joins</span><span class="p">]</span>
            <span class="c1"># the joined tables can have an alias. We handle the two cases here</span>
            <span class="n">join</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">join_type</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1"> AS </span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">alias</span><span class="si">}</span><span class="s1"> &#39;</span>
                                    <span class="sa">f</span><span class="s1">&#39;ON </span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_left</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.&quot;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_left</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; = &#39;</span>
                                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">alias</span><span class="si">}</span><span class="s1">.&quot;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_right</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
                                   <span class="k">if</span> <span class="n">join</span><span class="o">.</span><span class="n">alias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span>
                                   <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">join_type</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1"> ON </span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_left</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.&quot;&#39;</span>
                                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_left</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; = </span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_right</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.&quot;&#39;</span>
                                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">join</span><span class="o">.</span><span class="n">column_right</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">join</span> <span class="ow">in</span> <span class="n">unique_joins</span><span class="p">])</span>

        <span class="c1"># criteria</span>
        <span class="k">if</span> <span class="n">criteria</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; WHERE </span><span class="si">{</span><span class="s1">&#39; AND &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">criteria</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT</span><span class="si">{</span><span class="n">distinct_results</span><span class="si">}{</span><span class="n">top_part</span><span class="si">}{</span><span class="n">columns</span><span class="si">}</span><span class="s2"> FROM </span><span class="si">{</span><span class="n">from_table</span><span class="si">}{</span><span class="n">join</span><span class="si">}{</span><span class="n">criteria</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_tap</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">,</span>
                                  <span class="n">maxrec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hardlimit</span><span class="p">,</span>
                                  <span class="o">**</span><span class="n">uploads</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">top</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The request executed correctly, but there was no data corresponding&quot;</span>
                          <span class="s2">&quot; to these criteria in SIMBAD&quot;</span><span class="p">,</span> <span class="n">NoResultsWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>



<span class="n">Simbad</span> <span class="o">=</span> <span class="n">SimbadClass</span><span class="p">()</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2025, The Astroquery Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.4.7. &nbsp;
    Last built 01 Apr 2025. <br/>
  </p>
</footer>
  </body>
</html>